@model FastGooey.Models.ViewModels.Media.MediaWorkspaceViewModel

<div id="editor" class="mx-auto max-w-5xl mt-8">
    <div class="formGroup formGroupAddBackground mb-6">
        <div class="w-full border-b border-b-zinc-300 py-2 px-4">
            <div class="flex items-center justify-between gap-2">
                <div>
                    <p class="font-semibold">@Model.Source.Name</p>
                    <p class="text-xs text-zinc-500">@Model.Source.SourceType</p>
                </div>
                @if (!string.IsNullOrWhiteSpace(Model.Source.DetailLine))
                {
                    <p class="text-xs text-zinc-500">@Model.Source.DetailLine</p>
                }
            </div>
        </div>
        <div class="px-4 py-3">
            <div class="flex flex-wrap items-center gap-2 text-sm text-zinc-600">
                @foreach (var crumb in Model.Breadcrumbs)
                {
                    <button
                        type="button"
                        hx-get="@Url.Action("Browse", "Media", new { workspaceId = Model.WorkspaceId, sourceId = Model.Source.SourceId, path = crumb.Path })"
                        hx-target="#workspaceEditor"
                        class="rounded px-2 py-1 hover:bg-zinc-100">
                        @crumb.Label
                    </button>
                    @if (crumb != Model.Breadcrumbs.Last())
                    {
                        <span class="text-zinc-400">/</span>
                    }
                }
            </div>
        </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <div class="lg:col-span-2">
            <div class="formGroup formGroupAddBackground">
                <div class="w-full border-b border-b-zinc-300 py-2 px-4">
                    <p class="font-semibold">Contents</p>
                </div>
                <div class="px-4 py-3">
                    @if (!string.IsNullOrWhiteSpace(Model.ErrorMessage))
                    {
                        <p class="text-sm text-red-600">@Model.ErrorMessage</p>
                    }
                    else if (!Model.Items.Any())
                    {
                        <p class="text-sm text-zinc-500">No items found in this folder.</p>
                    }
                    else
                    {
                        <ul class="divide-y divide-zinc-200">
                            @foreach (var item in Model.Items)
                            {
                                <li class="py-2 flex items-center justify-between gap-4">
                                    <div class="flex items-center gap-3">
                                        @if (item.IsFolder)
                                        {
                                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-5 text-amber-500">
                                                <path d="M19.5 7.5h-7.5l-1.5-1.5h-6A1.5 1.5 0 0 0 3 7.5v9a1.5 1.5 0 0 0 1.5 1.5h15a1.5 1.5 0 0 0 1.5-1.5v-7.5A1.5 1.5 0 0 0 19.5 7.5Z" />
                                            </svg>
                                        }
                                        else if (item.IsImage)
                                        {
                                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-5 text-blueMid">
                                                <path d="M3 5.25A2.25 2.25 0 0 1 5.25 3h13.5A2.25 2.25 0 0 1 21 5.25v13.5A2.25 2.25 0 0 1 18.75 21H5.25A2.25 2.25 0 0 1 3 18.75V5.25Zm3.75 10.5a.75.75 0 0 0-.53 1.28l1.47 1.47a.75.75 0 0 0 1.06 0l2.72-2.72 2.03 2.03a.75.75 0 0 0 1.06 0l1.47-1.47a.75.75 0 1 0-1.06-1.06l-.94.94-2.03-2.03a.75.75 0 0 0-1.06 0l-2.72 2.72-.94-.94a.75.75 0 0 0-.53-.22Z" />
                                            </svg>
                                        }
                                        else
                                        {
                                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="size-5 text-zinc-400">
                                                <path d="M6.75 3A2.25 2.25 0 0 0 4.5 5.25v13.5A2.25 2.25 0 0 0 6.75 21h10.5A2.25 2.25 0 0 0 19.5 18.75V8.25L14.25 3H6.75Z" />
                                            </svg>
                                        }
                                        <div>
                                            <p class="text-sm font-medium text-zinc-700">@item.Name</p>
                                            @if (item.Size.HasValue && !item.IsFolder)
                                            {
                                                <p class="text-xs text-zinc-500">@item.Size.Value.ToString("N0") bytes</p>
                                            }
                                        </div>
                                    </div>
                                    <div class="flex items-center gap-2">
                                        @if (item.IsFolder)
                                        {
                                            <button
                                                type="button"
                                                hx-get="@Url.Action("Browse", "Media", new { workspaceId = Model.WorkspaceId, sourceId = Model.Source.SourceId, path = item.Path })"
                                                hx-target="#workspaceEditor"
                                                class="text-sm text-blueMid hover:underline">
                                                Open
                                            </button>
                                        }
                                        else if (item.IsImage)
                                        {
                                            <button
                                                type="button"
                                                hx-get="@Url.Action("PreviewPanel", "Media", new { workspaceId = Model.WorkspaceId, sourceId = Model.Source.SourceId, path = item.Path, name = item.Name, contentType = item.ContentType })"
                                                hx-target="#mediaPreview"
                                                class="text-sm text-blueMid hover:underline">
                                                Preview
                                            </button>
                                        }
                                        @if (!item.IsFolder)
                                        {
                                            <a href="@Url.Action("Preview", "Media", new { workspaceId = Model.WorkspaceId, sourceId = Model.Source.SourceId, path = item.Path })"
                                               target="_blank"
                                               rel="noopener"
                                               class="text-sm text-zinc-500 hover:text-zinc-700">
                                                Open file
                                            </a>
                                        }
                                    </div>
                                </li>
                            }
                        </ul>
                    }
                </div>
            </div>
        </div>
        <div class="lg:col-span-1" id="mediaPreview">
            <div class="formGroup formGroupAddBackground h-full">
                <div class="w-full border-b border-b-zinc-300 py-2 px-4">
                    <p class="font-semibold">Preview</p>
                </div>
                <div class="px-4 py-6 text-sm text-zinc-500">
                    Select an image to preview it here.
                </div>
            </div>
        </div>
    </div>
</div>

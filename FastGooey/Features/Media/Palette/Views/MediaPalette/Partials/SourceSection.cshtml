@model FastGooey.Features.Media.Shared.Models.ViewModels.Media.MediaPaletteSourceViewModel

<div class="mb-2" data-media-palette-source="true">
    <div class="w-full p-2 bg-zinc-200">
        <div class="flex items-center justify-between">
            <h3 class="text-xs font-semibold uppercase">@Model.Name</h3>
            <span class="text-[11px] text-zinc-500">@Model.SourceType</span>
        </div>
        @if (!string.IsNullOrWhiteSpace(Model.DetailLine))
        {
            <p class="text-[11px] text-zinc-500">@Model.DetailLine</p>
        }
        @if (!string.IsNullOrWhiteSpace(Model.StatusLine))
        {
            <p class="text-[11px] text-red-500">@Model.StatusLine</p>
        }
    </div>
    <div class="w-full grid grid-cols-4 gap-2 p-2" data-media-palette-grid="true">
        @if (!string.IsNullOrWhiteSpace(Model.StatusLine))
        {
            <p class="col-span-4 text-center text-zinc-500">No media available.</p>
        }
        else if (Model.Items.Count == 0)
        {
            <p class="col-span-4 text-center text-zinc-500">No images found.</p>
        }
        else
        {
            foreach (var item in Model.Items)
            {
                <button type="button"
                        class="text-left rounded-md border border-transparent hover:bg-zinc-100 p-2 transition"
                        onclick="selectMediaPickerItem(this); let input = document.getElementById('mediaPickerCustomUrl'); if (input) input.value = ''"
                        data-media-picker-item="true"
                        data-media-source-id="@Model.SourceId"
                        data-media-source-name="@Model.Name"
                        data-media-path="@item.Path"
                        data-media-label="@item.Name">
                    <img src="@Url.Action("Preview", "Media", new { workspaceId = Model.WorkspaceId, sourceId = Model.SourceId, path = item.Path })"
                         alt="@item.Name"
                         class="rounded w-full h-20 object-cover"
                         loading="lazy" />
                    <p class="text-sm truncate">@item.Name</p>
                </button>
            }
        }
    </div>
    @if (Model.HasMore)
    {
        <button type="button"
                class="text-blue-500 font-medium mx-2 text-sm"
                hx-get="@Url.Action("SourceSection", "MediaPalette", new { workspaceId = Model.WorkspaceId, sourceId = Model.SourceId, take = Model.NextCount })"
                hx-target="closest [data-media-palette-source]"
                hx-swap="outerHTML">
            Load more...
        </button>
    }
</div>
